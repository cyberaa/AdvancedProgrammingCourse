
<!-- saved from url=(0065)http://mooshak.dei.uc.pt/~lpa/cgi-bin/execute/528354773078?view+L -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="stylesheet" href="base.css" type="text/css">
<style type="text/css"></style></head>
<body>
<center>
<table cellpadding="20" width="100%">
<tbody><tr>
<td id="Base">

<title>Problem M - The Dancing Problem </title>


<h1 align="CENTER">Problem M - The Dancing Problem</h1>

<hr>


<h2>Description</h2>

Students are organizing a final-year dance contest. Students have to register for the contest as pairs (a man and a woman), and individual students can register more than once, but always with a different pair. However, since there were many registrations, the organizers decided to impose limits on how many times each student could dance:<p>

1) Each pair cannot do more than a certain number of dances together.</p><p>

2) Each student cannot do more than a certain number of dances.</p><p>

Still, the dance contest should run all night long. Therefore, given a set of registrations, they want to choose the dancing pairs such that the total number of dances is maximized according to the rules above.</p><p>

<img src="528354773078">


</p><hr>

<h2>Input</h2> 

The input may consist of several test cases. The first line of each test case gives the number of
male-female pairs (<i>n</i>). The second line gives the maximum number of dances
that each individual student and each pair can do, respectively. Then,
the description of each pair is given in the next <i>n</i> lines, consisting
of two integers in a line. The first integer identifies the man, and the second
integer identifies the woman. A new test case may follow, starting on the next line.

<p>There are fewer than 200 men and 200 women in all test cases.
</p><hr>

<h2>Output</h2>

The output is the maximum number of dances for each test case,
printed on consecutive lines.
<p>
</p><hr>

<h2> Example</h2>

<p><b>Example input:</b></p>

<blockquote><pre>10 4 4
2 5
1 1
1 4
1 2
2 4
2 3
2 1
2 2
3 1
3 4
4 3
</pre></blockquote>

<p>
</p><hr>

<p><b>Example output:</b></p>


<blockquote><pre>8
</pre></blockquote>

<hr>



</td>
</tr>
</tbody></table>
</center>


</body><link rel="stylesheet" type="text/css" href="data:text/css,"></html>